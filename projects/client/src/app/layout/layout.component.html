<div
  *ngIf="{
    theme: theme$ | async,
    isDesktop: isBreakpointXLargeMatched$ | async,
    contentOfHeader: contentOfHeader$ | async,
    contentOfNavigator: contentOfNavigator$ | async,
    navigatingAndBlocked: navigatingAndBlocked$ | async
  } as data"
  class="relative flex h-full flex-col"
  (navigationStart)="navigating$.next(true)"
  (navigationEnd)="navigating$.next(false)"
>
  <mat-toolbar
    *ngIf="data.contentOfHeader"
    class="z-[2] order-4 shadow-z4 dark:text-d-primary-text md:order-2"
    [color]="data.theme == 'light' ? 'primary' : undefined"
  >
    <ng-container [cdkPortalOutlet]="data.contentOfHeader"></ng-container>
  </mat-toolbar>

  <div *ngIf="data.navigatingAndBlocked" class="absolute inset-0 z-10">
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
  </div>

  <mat-sidenav-container class="order-3 h-full flex-1 overflow-auto">
    <mat-sidenav
      *ngIf="data.contentOfNavigator"
      class="w-64"
      [class]="{ 'bg-transparent': data.isDesktop }"
      [opened]="data.isDesktop"
      [mode]="data.isDesktop ? 'side' : 'over'"
      (navigationStart)="data.isDesktop ? null : navigatorSide?.close()"
    >
      <ng-container [cdkPortalOutlet]="data.contentOfNavigator"></ng-container>
    </mat-sidenav>
    <mat-sidenav-content>
      <ng-content></ng-content>
    </mat-sidenav-content>
  </mat-sidenav-container>

  <ng-container *ngIf="data.contentOfNavigator">
    <ng-template appModal>
      <div class="h-[60vh]">
        <ng-container
          [cdkPortalOutlet]="data.contentOfNavigator"
          (navigationStart)="navigatorBottom?.close()"
        ></ng-container>
      </div>
    </ng-template>
  </ng-container>
</div>
